# ci_stage_lib_merge : merge# ci_stage_update_whitelist : update_whiteList# ci_stage_open_PR : open_PR# image_name : registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:Dymola_2022-miniconda# python_version : myenv# git_url : https://github.com/ibpsa/modelica-ibpsa.git# library : AixLib# merge_branch : CustomIBPSA_Merge# modelicapyci_library_merge_module : ModelicaPyCI.deploy.ibpsa_merge# arg_lib : --merge-library-mos-scripts Resources/Scripts/Conversion --temporary-mos-path Convertmos --merge-library-dir IBPSA_folder --merge-library IBPSA --library-mos-scripts Resources/Scripts --library-dir temp_AixLib --library AixLib # ci_trigger_ibpsa_commit : ci_trigger_ibpsa# expire_in_time : 7h# modelicapyci_html_tidy_module : ModelicaPyCI.syntax.html_tidy# arg_whitelist_html : --whitelist-flag  --log-flag  --root-whitelist-library modelica-ibpsa --git-url https://github.com/ibpsa/modelica-ibpsa.git --whitelist-library IBPSA --library AixLib # arg_whitelist_check : --git-url https://github.com/ibpsa/modelica-ibpsa.git --dym-options DYM_CHECK --create-whitelist-flag  --changed-flag  --dymola-version 2022 --root-whitelist-library modelica-ibpsa --whitelist-library IBPSA --root-library AixLib\package.mo --packages Airflow --library AixLib # arg_whitelist_sim : --git-url https://github.com/ibpsa/modelica-ibpsa.git --dym-options DYM_SIM --create-whitelist-flag  --changed-flag  --dymola-version 2022 --root-whitelist-library modelica-ibpsa --whitelist-library IBPSA --root-library AixLib\package.mo --packages Airflow --library AixLib # modelicapyci_test_validate_module : ModelicaPyCI.unittest.checkpackages.validatetest# xvfb_flag : xvfb-run -n 77# arg_lock :  --lock-library IBPSA --library AixLib # whitelist_library : IBPSA# bot_merge_commit : CI message from ebc-aixlib-bot. Merge of 'IBPSA' library. Update files dymola-ci-tests/ci_whitelist/ci_check_whitelist.txt and dymola-ci-tests/ci_whitelist/rci_html_whitelist.txt# result_dir : dymola-ci-tests\result# modelicapyci_api_github_module : ModelicaPyCI.api_script.api_github# arg_api_pr : --gitlab-page https://ebc.pages.rwth-aachen.de/EBC_all/github_ci/AixLib --github-token ${GITHUB_API_TOKEN} --base-branch main --working-branch ${TARGET_BRANCH} --github-repository RWTH-EBC/AixLib # merge_library_dir: IBPSA_folderinclude: 'bin/ci-tests/utilities.yml'stages:    - merge    - update_whiteList    - open_PRIBPSA:    image: registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:Dymola_2022-miniconda    stage: merge    before_script:        - !reference [.clone_ci_templates, script]        - !reference [.github_ssh_auth, script]    script:        - cd ..        - cp -R AixLib temp_AixLib        - rm -r IBPSA_folder || echo "all clear to clone"        - git clone https://github.com/ibpsa/modelica-ibpsa.git IBPSA_folder        - python -m ModelicaPyCI.deploy.ibpsa_merge --merge-library-mos-scripts Resources/Scripts/Conversion --temporary-mos-path Convertmos --merge-library-dir IBPSA_folder --merge-library IBPSA --library-mos-scripts Resources/Scripts --library-dir temp_AixLib --library AixLib         - rm -r IBPSA_folder        - mkdir $CI_PROJECT_NAME/Merge_Package        - cp -R temp_AixLib $CI_PROJECT_NAME/Merge_Package        - rm -r temp_AixLib    rules:        - if: $CI_PIPELINE_SOURCE == "push" && $CI_COMMIT_BRANCH == "CustomIBPSA_Merge" && $CI_COMMIT_MESSAGE =~ /ci_trigger_ibpsa/          when: always    artifacts:        paths:            - Merge_Package        expire_in: 7hWhiteList:    image: registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:Dymola_2022-miniconda    stage: update_whiteList    before_script:        - !reference [.clone_ci_templates, script]        - !reference [.github_ssh_auth, script]    script:        - cd Merge_Package        - python -m ModelicaPyCI.syntax.html_tidy --whitelist-flag  --log-flag  --root-whitelist-library modelica-ibpsa --git-url https://github.com/ibpsa/modelica-ibpsa.git --whitelist-library IBPSA --library AixLib         - xvfb-run -n 77 python -m ModelicaPyCI.unittest.checkpackages.validatetest --git-url https://github.com/ibpsa/modelica-ibpsa.git --dym-options DYM_CHECK --create-whitelist-flag  --changed-flag  --dymola-version 2022 --root-whitelist-library modelica-ibpsa --whitelist-library IBPSA --root-library AixLib\package.mo --packages Airflow --library AixLib         - xvfb-run -n 77 python -m ModelicaPyCI.unittest.checkpackages.validatetest --git-url https://github.com/ibpsa/modelica-ibpsa.git --dym-options DYM_SIM --create-whitelist-flag  --changed-flag  --dymola-version 2022 --root-whitelist-library modelica-ibpsa --whitelist-library IBPSA --root-library AixLib\package.mo --packages Airflow --library AixLib         - python -m ModelicaPyCI.converter.lock_model --lock-library IBPSA --library AixLib         - rm -r IBPSA        - message="CI message from ebc-aixlib-bot. Merge of 'IBPSA' library. Update files dymola-ci-tests/ci_whitelist/ci_check_whitelist.txt and dymola-ci-tests/ci_whitelist/rci_html_whitelist.txt"        - push_model=$(git ls-files --others --exclude-standard --directory AixLib)        - git add $push_model        - git commit -m "$message"        - git push --force git@github.com:$Github_Repository.git    rules:        - if: $CI_PIPELINE_SOURCE == "push" && $CI_COMMIT_BRANCH == "CustomIBPSA_Merge" && $CI_COMMIT_MESSAGE =~ /ci_trigger_ibpsa/          when: always    artifacts:        paths:            - Merge_Package        expire_in: 7h    allow_failure: true    needs:    - job: IBPSA      artifacts: trueIBPSA_Pull_Request:    image: registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:Dymola_2022-miniconda    stage: open_PR    before_script:        - !reference [.clone_ci_templates, script]        - git config --global user.name "$GITLAB_USER_NAME"        - git config --global user.email "$GITLAB_USER_EMAIL"    script:       - python -m ModelicaPyCI.api_script.api_github --gitlab-page https://ebc.pages.rwth-aachen.de/EBC_all/github_ci/AixLib --github-token ${GITHUB_API_TOKEN} --base-branch main --working-branch ${TARGET_BRANCH} --github-repository RWTH-EBC/AixLib     rules:       - if: $CI_PIPELINE_SOURCE == "push" && $CI_COMMIT_BRANCH == "CustomIBPSA_Merge" && $CI_COMMIT_MESSAGE =~ /ci_trigger_ibpsa/         when: always